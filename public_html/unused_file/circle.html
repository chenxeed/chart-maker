<!--
To change this template, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html>
    <head>
        <title>Chart Maker</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <link rel="stylesheet" href="style.css" type="text/css">
    </head>
    <body>
        <h1>SIMPLE CHART MAKER</h1>

        <div class="chart-wrapper">
            <svg width="500px" height="500px">
            <path id="pieChart" class="piechart" />
            </svg>
        </div>

        <div class="control">
            <div>Angle From : <input type="number" name="angle-from" id="angleFrom" /></div>
            <div>Angle To : <input type="number" name="angle-to" id="angleTo" /></div>
        </div>

        <script>
            var angleFrom, angleTo;
            var angleFromValue = 0;
            var angleToValue = 360;
            var chartFromX = 250;
            var chartFromY = 200;
            var chartA = 159;
            var chartArcFlag = 0;
            var chartD;

            window.onload = function() {

                updateChart();

                angleFrom = document.getElementById('angleFrom');
                angleTo = document.getElementById('angleTo');
                
                
                angleFrom.value = angleFromValue;
                angleTo.value = angleToValue;
                
                angleFrom.addEventListener("change", function(e) {
                    validateValue(this);
                    angleFromValue = this.value;
                    updateChart();
                });

                angleTo.addEventListener("change", function(e) {
                    validateValue(this);
                    angleToValue = this.value;
                    updateChart();
                });
            }
            
            function validateValue(e) {
                if(e.value < 0){
                    e.value = 0;
                }else if(e.value > 360){
                    e.value = 360;
                }else if(e.id === 'angleFrom' && parseInt(e.value) > parseInt(angleTo.value)){
                    e.value = angleTo.value;
                }else if(e.id === 'angleTo' && parseInt(e.value) < parseInt(angleFrom.value)){
                    e.value = angleFrom.value;
                }
            }

            function updateChart() {
                
                var angleDiff = Math.abs(angleFromValue-angleToValue);
                var from = chartA/180 * angleFromValue;
				var to = chartA/180 * angleToValue;
				
                if(angleDiff <= 180)
                    chartArcFlag = 0;
                else
                    chartArcFlag = 1;
                
                if(angleDiff === 360)
                {
                    chartD = "M"+(chartFromX+chartA)+","+chartFromY+" A"+chartA+","+chartA+" 0 1,0 "+(chartFromX-chartA)+","+chartFromY+" A"+chartA+","+chartA+" 0 1,0 "+(chartFromX+chartA)+","+chartFromY;                       
                }else{
                    x1 = chartFromX + chartA * Math.cos(Math.PI * from / chartA);
                    y1 = chartFromY + chartA * Math.sin(Math.PI * from / chartA);
                    x2 = chartFromX + chartA * Math.cos(Math.PI * to / chartA);
                    y2 = chartFromY + chartA * Math.sin(Math.PI * to / chartA);
                    chartD = "M"+chartFromX+","+chartFromY+" L"+x1+","+y1+" A"+chartA+","+chartA+" 0 "+chartArcFlag+",1 "+x2+","+y2+" z";
                }
                console.log(chartD);
                document.getElementById('pieChart').setAttribute('d',chartD);
            }

        </script>
    </body>
</html>
